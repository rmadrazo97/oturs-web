!function(i){"use strict";var r,n,o,a,l,u,m;i(document).on("click",".next-form",function(e){if(e.preventDefault(),!m){m=!0;var t=i(this),o=(i("#townhub-checkout-form")[0],!1),s=null;if(r=t.closest(".ck-fieldset-item"),(n=r.next(".ck-fieldset-item")).length){i(".ck-input-error").remove(),i(".inp-error").removeClass("inp-error");var c=r.find("input");c.length&&c.each(function(){var e=i(this);if("hidden"===e.prop("type")||!0===e.prop("disabled"))return!0;if(!0===e.prop("required")){if(""==e.val()&&("text"===e.prop("type")||"number"===e.prop("type")||"email"===e.prop("type")))return s=this,!(o=!0);if(!1===e.prop("checked")&&("checkbox"===e.prop("type")||"radio"===e.prop("type")))return s=this,!(o=!0)}}),o?(i(s).after('<span class="ck-input-error">'+s.validationMessage+"</span>"),i(s).addClass("inp-error"),m=!1):(i(".ck-input-error").remove(),i(".inp-error").removeClass("inp-error"),i(".ck-tab-item").removeClass("active"),i(".ck-tab-item").eq(i(".ck-fieldset-item").index(n)).addClass("active"),n.show(),r.animate({opacity:0},{step:function(e,t){u=1-.2*(1-e),a=50*e+"%",l=1-e,r.css({transform:"scale("+u+")",position:"absolute"}),n.css({left:a,opacity:l,position:"relative"})},duration:1200,complete:function(){r.hide(),m=!1},easing:"easeInOutBack"}))}}}),i(document).on("click",".back-form",function(e){if(e.preventDefault(),m)return!1;m=!0;var t=i(this);r=t.closest(".ck-fieldset-item"),o=t.closest(".ck-fieldset-item").prev(".ck-fieldset-item"),i(".ck-tab-item").removeClass("active"),i(".ck-tab-item").eq(i(".ck-fieldset-item").index(o)).addClass("active"),o.show(),r.animate({opacity:0},{step:function(e,t){u=.8+.2*(1-e),a=50*(1-e)+"%",l=1-e,r.css({left:a,position:"absolute"}),o.css({transform:"scale("+u+")",opacity:l,position:"relative"})},duration:1200,complete:function(){r.hide(),m=!1},easing:"easeInOutBack"})}),i(document).on("submit","#townhub-checkout-form",function(e){e.preventDefault();var t=new FormData(this),n=i(this),a=i(this).find(".lcheckout_btn");a.addClass("loading"),t.append("action","checkout_form"),i.ajax({type:"POST",url:_townhub_add_ons.url,dataType:"json",data:t,cache:!1,contentType:!1,processData:!1,success:function(e){if(null!=e.debug&&1==e.debug&&console.log(e),e.success)if(a.removeClass("loading"),null!=e.scform_data&&""!=e.scform_data&&null!=e.scform_url){var t=document.createElement("form");if(null!=e.scform_class&&""!=e.scform_class?t.className="ck-second-form "+e.scform_class:t.className="ck-second-form",t.method="POST",t.action=e.scform_url,e.scform_data instanceof Object)for(var o in e.scform_data){var s=document.createElement("INPUT");s.name=o,s.value=e.scform_data[o],s.type="hidden",t.appendChild(s)}if(n.before(t),null!=e.scform_before&&""!=e.scform_before&&n.before(e.scform_before),n.remove(),null!=e.scform_submit&&1==e.scform_submit)t.submit();else{var c=document.createElement("INPUT");c.name="submit",c.value="Confirm",c.type="submit",t.appendChild(c)}}else{if(null!=e.strip_checkout&&1==e.strip_checkout)return Stripe(_townhub_add_ons_payments.publishable_key).redirectToCheckout({sessionId:e.sessionId}).then(function(e){e.error&&alert(e.error.message)});if(null!=e.custom_checkout&&1==e.custom_checkout){var r=new CustomEvent("cthCustomCheckout",{detail:e});window.dispatchEvent(r)}else null!=e.url&&""!=e.url?window.location.href=e.url:i("#ck-tab-ck_confirm").length&&i("#ck-fieldset-ck_confirm").length?(i(".ck-tab-item").removeClass("active"),i("#ck-tab-ck_confirm").addClass("active"),i(".ck-fieldset-item").hide(),i("#ck-fieldset-ck_confirm").show().addClass("ck-fieldset-show")):null!=e.result&&""!=e.result&&(i("#ck-tab-ck_confirm").length&&(i(".ck-tab-item").removeClass("active"),i("#ck-tab-ck_confirm").addClass("active")),n.before(e.result),n.remove())}else null!=e.message&&console.log(e.message)},error:function(e){console.log(e)}})}),i(document).on("change",'input[type="radio"][name="payment-method"]',function(e){e.preventDefault();var t=i(this).data("btn")||"",o=(i(this).val(),i("#lcheckout_btn"));t&&o.children(".btn-text").text(t)})}(jQuery);